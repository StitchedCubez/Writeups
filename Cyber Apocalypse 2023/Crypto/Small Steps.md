Description: 
As you continue your journey, you must learn about the encryption method the aliens used to secure their communication from eavesdroppers. The engineering team has designed a challenge that emulates the exact parameters of the aliens' encryption system, complete with instructions and a code snippet to connect to a mock alien server. Your task is to break it.

Downloaded 'crypto_small_steps' zip file

Unzip crypto_small_steps

- Contains 'README.md', 'solver.py', 'server.py' files
- Also spawned instance on HTB CTF page
- Read 'README.md' file > says "The implementation is textbook RSA, except for the value of 'e'."

Connected to spawned instance via nc
	
  - Prompts 2 options (E for encrypted flag and A for abort session)
	
  - Entered E and got 'encrypted flag', 'N', and 'e' values

Encrypted flag: 70407336670535933819674104208890254240063781538460394662998902860952366439176467447947737680952277637330523818962104685553250402512989897886053

Public Key: 

N: 4613386355169282911171329604089633978183811587299552176077898072433006483464828577784489484004816206066435160949609443116263095113206466689842247992485129

e: 3

```
subl server.py
```
- 'N' was generated by multiplying 2 random prime numbers within range of 0-256

- 'e' value is set to 3

- Original plaintext flag was converted into bytes using bytes_to_long function (plaintext = bytes_to_long(plaintext))

- All 3 numbers then plugged into pow function

```
plaintext**e % N = encrypted flag
return pow(plaintext, e, n)
```
- % represent modulo to find the remainder 

- encrypted flag = remainder of above equation
	
Tried solving for plaintext bytes by solving for the reverse of this pow function

Provided numbers are way too large to try calculating and solving mathematically or through python

Searched Google on how to decrypt ciphertext with only RSA public key and no private key

Searched how to reverse 3 parameter pow function in Python

- Found https://stackoverflow.com/questions/49818392/how-to-find-reverse-of-powa-b-c-in-python
	
- With the size of the numbers provided for this challenge, this python script would not be effective for a solution

Continued to do more research on RSA encryption and found that n and e are the standard variables for RSA

Googled "how to decrypt RSA ciphertext with only n and e"

- Found https://stackoverflow.com/questions/49878381/rsa-decryption-using-only-n-e-and-c

- Advised using RsaCtfTool to decrypt cipher text as it supports decryption with only n and e values
	
Downloaded RsaCtfTool onto Kali Linux VM
	
```
git clone https://github.com/Ganapati/RsaCtfTool.git
sudo apt-get install libgmp3-dev libmpc-dev
pip3 install -r "requirements.txt"

python3 RsaCtfTool.py -n 4613386355169282911171329604089633978183811587299552176077898072433006483464828577784489484004816206066435160949609443116263095113206466689842247992485129 -e 3 --uncipher 70407336670535933819674104208890254240063781538460394662998902860952366439176467447947737680952277637330523818962104685553250402512989897886053
```


RETRIEVED FLAG
